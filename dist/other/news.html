<!doctype html>
<html lang="en" data-pc-preset="preset-1" data-pc-sidebar-caption="true" data-pc-direction="ltr" dir="ltr" data-pc-theme="light">
<head>
  <title>News</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="description" content="News Page - ShadowLink Platform" />
  <meta name="author" content="ShadowLink Team 9" />
  <link rel="icon" href="../assets/images/shadow_link_symbol.svg" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../assets/fonts/phosphor/duotone/style.css" />
  <link rel="stylesheet" href="../assets/fonts/tabler-icons.min.css" />
  <link rel="stylesheet" href="../assets/fonts/feather.css" />
  <link rel="stylesheet" href="../assets/fonts/fontawesome.css" />
  <link rel="stylesheet" href="../assets/fonts/material.css" />
  <link rel="stylesheet" href="../assets/css/style.css" id="main-style-link" />
  <style>
    .line-clamp-2 {
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }
    .line-clamp-3 {
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }
  </style>
</head>

<body>
  <div class="loader-bg fixed inset-0 bg-white z-[1034]">
    <div class="loader-track h-[5px] w-full inline-block absolute overflow-hidden top-0">
      <div class="loader-fill w-[300px] h-[5px] bg-primary-500 absolute top-0 left-0 animate-[hitZak_0.6s_ease-in-out_infinite_alternate]"></div>
    </div>
  </div>

  <!-- Sidebar -->
  <nav class="pc-sidebar">
    <div class="navbar-wrapper">
      <div class="m-header flex items-center py-4 px-6 h-header-height">
        <a href="../index.html" class="b-brand flex items-center gap-3">
          <div style="display: flex; justify-content: center; align-items: center;">
            <img src="../assets/images/shadow_link_dark.svg"
              style="width: 80px; background-color: white; padding: 8px; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);" />
          </div>
        </a>
      </div>
      <div class="navbar-content py-2.5">
        <ul class="pc-navbar">
          <li class="pc-item pc-caption"><label>Navigation</label></li>
          <li class="pc-item"><a href="../index.html" class="pc-link"><span class="pc-micon"><i data-feather="home"></i></span><span class="pc-mtext">Dashboard</span></a></li>

          <li class="pc-item pc-caption"><label>MITRE</label><i data-feather="shield"></i></li>
          <li class="pc-item"><a href="mitre.html" class="pc-link"><span class="pc-micon"><i data-feather="target"></i></span><span class="pc-mtext">MITRE ATT&CK¬Æ</span></a></li>

          <li class="pc-item pc-caption"><label>Other</label></li>
          <li class="pc-item"><a href="news.html" class="pc-link"><span class="pc-micon"><i data-feather="activity"></i></span><span class="pc-mtext">News</span></a></li>
          <li class="pc-item"><a href="support.html" class="pc-link"><span class="pc-micon"><i data-feather="help-circle"></i></span><span class="pc-mtext">Support</span></a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="pc-header">
    <div class="header-wrapper flex max-sm:px-[15px] px-[25px] grow">
      <div class="me-auto pc-mob-drp">
        <ul class="inline-flex *:min-h-header-height *:inline-flex *:items-center">
          <li class="pc-h-item pc-sidebar-collapse max-lg:hidden lg:inline-flex">
            <a href="#" class="pc-head-link" id="sidebar-hide"><i data-feather="menu"></i></a>
          </li>
          <li class="pc-h-item pc-sidebar-popup lg:hidden">
            <a href="#" class="pc-head-link" id="mobile-collapse"><i data-feather="menu"></i></a>
          </li>
        </ul>
      </div>
      <div class="ms-auto">
        <ul class="inline-flex *:min-h-header-height *:inline-flex *:items-center">
          <li class="dropdown pc-h-item">
            <a class="pc-head-link dropdown-toggle me-0" data-pc-toggle="dropdown" href="#"><i data-feather="sun"></i></a>
            <div class="dropdown-menu dropdown-menu-end pc-h-dropdown">
              <a href="#" class="dropdown-item" onclick="layout_change('dark')"><i data-feather="moon"></i><span>Dark</span></a>
              <a href="#" class="dropdown-item" onclick="layout_change('light')"><i data-feather="sun"></i><span>Light</span></a>
              <a href="#" class="dropdown-item" onclick="layout_change_default()"><i data-feather="settings"></i><span>Default</span></a>
            </div>
          </li>
          <li class="dropdown pc-h-item header-user-profile">
            <a class="pc-head-link dropdown-toggle" data-pc-toggle="dropdown" href="#"><i data-feather="user"></i></a>
            <div class="dropdown-menu dropdown-user-profile dropdown-menu-end pc-h-dropdown p-2 overflow-hidden">
              <div class="dropdown-header flex items-center justify-between py-4 px-5 bg-primary-500">
                <div class="flex mb-1 items-center">
                  <div class="shrink-0">
                    <img src="{{ url_for('static', filename='images/user/avatar-7.jpg') }}" alt="user-image" class="w-10 rounded-full" />
                  </div>
                  <div class="grow ms-3">
                    <h6 class="mb-1 text-white">{{ current_user.first_name }} {{ current_user.last_name }}</h6>
                    <span class="text-white">{{ current_user.email[:5] + '...' + current_user.email.split('@')[-1] }}</span>
                  </div>
                </div>
              </div>
              <div class="dropdown-body py-4 px-5">
                <a href="../pages/login-v1.html" class="btn btn-primary w-full">Logout</a>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="pc-container">
    <div class="pc-content">
      <div class="page-header">
        <div class="page-block">
          <div class="page-header-title">
            <h5 class="mb-0 font-medium">News</h5>
          </div>
          <ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Other</a></li>
            <li class="breadcrumb-item active">News</li>
          </ul>
        </div>
      </div>

      <!-- News Grid -->
      <div class="grid grid-cols-12 gap-6 mt-4" id="news-feed">
        <!-- Cards will be inserted here -->
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="pc-footer">
    <div class="footer-wrapper container-fluid mx-10">
      <div class="col-span-12 text-right my-1">
        <p class="inline-block">Created by Team 9</p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="../assets/js/plugins/simplebar.min.js"></script>
  <script src="../assets/js/plugins/popper.min.js"></script>
  <script src="../assets/js/icon/custom-icon.js"></script>
  <script src="../assets/js/plugins/feather.min.js"></script>
  <script src="../assets/js/component.js"></script>
  <script src="../assets/js/theme.js"></script>
  <script src="../assets/js/script.js"></script>

  <!-- News Loader -->
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const container = document.getElementById("news-feed");

      try {
        const response = await fetch('/api/news');
        const newsList = await response.json();
        container.innerHTML = '';

        newsList.slice(0, 10).forEach(news => {
          const card = document.createElement('div');
          card.className = 'col-span-12 md:col-span-6 xl:col-span-4';
          card.innerHTML = `
            <div class="card shadow-lg hover:shadow-xl transition-shadow duration-300 h-full flex flex-col justify-between">
              <div class="card-body">
                <h5 class="text-lg font-semibold mb-2 text-primary-600 line-clamp-2">${news.title}</h5>
                <p class="text-sm text-gray-700 mb-3 line-clamp-3">${news.summary}</p>
              </div>
              <div class="px-4 pb-4 text-right text-xs text-gray-500">
                <span>üìÖ ${news.date}</span>
              </div>
            </div>
          `;
          container.appendChild(card);
        });
      } catch (error) {
        container.innerHTML = "<p class='text-red-600'>‚ö†Ô∏è Failed to load news.</p>";
        console.error(error);
      }
    });
  </script>
</body>
</html>
